# @package _global_

# to execute this experiment run:
# python train.py experiment=filter

defaults:
  - override /data: landmark
  - override /model: default
  - override /callbacks: filter
  - override /trainer: default

# all parameters below will be merged with parameters from default configurations set above
# this allows you to overwrite only specified parameters

tags: ["filter", "resnet18"]
seed: 59
# ckpt_path: /home/quangster/Workspace/filter-tiktok/facial-landmarks/logs/train/runs/2024-10-25_20-56-52/checkpoints/epoch_008.ckpt


# ------------------override paths------------------
# paths:
  # data_dir: ${paths.root_dir}/../../../


# ------------------override configs/trainer------------------
trainer:
  min_epochs: 1 # prevents early stopping
  max_epochs: 1


# ------------------override configs/model------------------
model:
  net:
    _target_: src.models.components.ResNet
    model_name: resnet18
    weights: DEFAULT
    output_shape: [68, 2]

    # _target_: src.models.components.CNN
    # output_shape: [68, 2]

  optimizer:
    _target_: torch.optim.Adam
    _partial_: true
    lr: 0.001
    weight_decay: 0.0

  scheduler:
    _target_: torch.optim.lr_scheduler.ReduceLROnPlateau
    _partial_: true
    mode: min
    factor: 0.1
    patience: 10


# ------------------override configs/data------------------
data:
  batch_size: 64
  num_workers: 0
  pin_memory: false

  train_transform:
    transforms:
      - _target_: albumentations.Resize
        height: 256
        width: 256
        always_apply: true
      - _target_: albumentations.Blur
        p: 0.2
      - _target_: albumentations.RGBShift
        r_shift_limit: 15
        g_shift_limit: 15
        b_shift_limit: 15
        p: 0.2 
      - _target_: albumentations.RandomBrightnessContrast
        p: 0.2
      - _target_: albumentations.ToGray
        p: 0.2
      - _target_: albumentations.ToFloat
        max_value: 255
        always_apply: true
      # - _target_: albumentations.Normalize
      #   mean: [0.485, 0.456, 0.406]
      #   std: [0.229, 0.224, 0.225]
      - _target_: albumentations.pytorch.transforms.ToTensorV2

  val_transform:
    transforms:
      - _target_: albumentations.Resize
        height: 256
        width: 256
        always_apply: true
      - _target_: albumentations.ToFloat
        max_value: 255
        always_apply: true
      # - _target_: albumentations.Normalize
      #   mean: [0.485, 0.456, 0.406]
      #   std: [0.229, 0.224, 0.225]
      - _target_: albumentations.pytorch.transforms.ToTensorV2


# ------------------override configs/logger------------------
logger:
  wandb:
    _target_: lightning.pytorch.loggers.wandb.WandbLogger
    name: "resnet18" # name of the run (normally generated by wandb)
    save_dir: "${paths.output_dir}"
    offline: False
    id: null # pass correct id to resume experiment!
    anonymous: null # enable anonymous logging
    project: "filter"
    log_model: True # upload lightning ckpts
    prefix: "" # a string to put at the beginning of metric keys
    # entity: "" # set to name of your wandb team
    group: ""
    tags: []
    job_type: ""
